import{r as v,a as A,n as Ze,g as el,c as f,o as u,d as t,w as r,e as b,E as w,I as ll,J as tl,b as y,G as R,H as z,h as j,f as p,C as L,i as S,p as ve,l as ue,K as ol,j as be,k as al,L as rl,m as _e}from"./index-B3ZjBOUV.js";import{l as sl,n as C}from"./index-BE28LO_H.js";import{i as nl}from"./index-4tqhF2Sn.js";import{_ as il}from"./_plugin-vue_export-helper-DlAUqK2U.js";const dl={class:"node-management"},ul={class:"card-header"},pl={class:"header-controls"},ml={class:"time-range-controls"},cl={class:"action-buttons"},gl={class:"temporal-properties-section"},fl={class:"temporal-properties-list"},yl={class:"temporal-properties-header"},vl={class:"temporal-controls"},bl={key:0,class:"time-hint"},_l={key:0,class:"temporal-charts"},Tl=["id"],wl={class:"temporal-property-actions"},Vl={key:1,class:"no-temporal-properties"},kl={key:0},Cl={key:1,class:"no-data"},$l={class:"pagination-container"},Pl={class:"dialog-footer"},hl={class:"dialog-footer"},Rl={class:"dialog-footer"},xl={class:"dialog-footer"},Nl={__name:"NodeManagement",setup(Ul){const Y=v(!1),Z=v(!1),D=v({}),K=v({}),Te=(l,e,a)=>{const s=`${e}_${a}`;l?(D.value[s]=l,console.log(`设置图表引用 ${s}:`,l)):D.value[s]&&(console.log(`清理图表引用 ${s}`),delete D.value[s])},pe=v([]),ee=v([]),F=v(1),W=v(50),me=v(0),G=A({label:""}),$=A({startTime:"",endTime:""}),we=Ze(()=>{let l=pe.value;return G.label&&(l=l.filter(e=>e.labels.includes(G.label))),l}),I=v(!1),M=v(!1),le=v(null),te=v(null),V=A({labels:[],properties:[{key:"",value:""}]}),Ve={},x=async()=>{Y.value=!0;try{const l=await sl.getAllLabels();ee.value=l.data||[];const e=await C.getNodesCount();me.value=parseInt(e.data)||0;const s=(await C.getNodesPaginated(F.value,W.value)).data||[],i=[];for(const d of s){const T={...d,temporalProperties:[],temporalLoading:!1,temporalCharts:[]};try{const k=await C.getTemporalProperty(d.id);T.temporalProperties=k.data||[]}catch(k){console.warn(`获取节点 ${d.id} 的时态属性失败:`,k),T.temporalProperties=[]}i.push(T)}pe.value=i}catch(l){console.error("获取节点数据失败:",l),w.error("获取节点数据失败，请检查后端服务是否正常运行")}finally{Y.value=!1}},ke=async l=>{W.value=l,F.value=1,await x()},Ce=async l=>{F.value=l,await x()},$e=()=>{F.value=1},Pe=()=>{M.value=!1,I.value=!0,te.value=null,V.labels=[],V.properties=[{key:"",value:""}]},he=l=>{M.value=!0,I.value=!0,te.value=l.id,V.labels=[...l.labels],V.properties=[];for(const[e,a]of Object.entries(l.properties))V.properties.push({key:e,value:a});V.properties.length===0&&V.properties.push({key:"",value:""})},Re=()=>{V.properties.push({key:"",value:""})},xe=l=>{V.properties.splice(l,1)},Ne=async()=>{var l,e;if(le.value)try{await le.value.validate(),Z.value=!0;const a={};V.properties.forEach(i=>{i.key&&i.value&&(a[i.key]=i.value)});let s=te.value;M.value?(await C.replaceNodeLabels(s,V.labels),await C.updateNodeProperties(s,a)):(s=(await C.createNode()).data.metadata.id,await C.addNodeLabels(s,V.labels),Object.keys(a).length>0&&await C.updateNodeProperties(s,a)),w.success(M.value?"节点更新成功":"节点创建成功"),I.value=!1,x()}catch(a){console.error("保存节点失败:",a),w.error((M.value?"更新节点失败: ":"创建节点失败: ")+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||a.message||"未知错误"))}finally{Z.value=!1}},Ue=l=>{_e.confirm("此操作将永久删除该节点，是否继续？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await C.deleteNode(l.id),w.success("删除成功"),x()}catch(e){console.error("删除节点失败:",e),w.error("删除节点失败，可能存在关联的关系")}}).catch(()=>{w.info("已取消删除")})};el(()=>{x()});const H=v(!1),B=v(!1),E=v(!1),oe=v(!1),ae=v(!1),re=v(!1),c=A({nodeId:"",propertyKey:"",time:"",value:""}),g=A({nodeId:"",propertyKey:"",startTime:"",endTime:"",value:""}),n=A({nodeId:"",propertyKey:"",createMode:"single",time:"",value:"",startTime:"",endTime:"",rangeValue:""}),se=v(null),ne=v(null),ie=v(null),ze={time:[{required:!0,message:"请输入时间",trigger:"blur"}],value:[{required:!0,message:"请输入属性值",trigger:"blur"}]},Le={startTime:[{required:!0,message:"请输入开始时间",trigger:"blur"}],endTime:[{required:!0,message:"请输入结束时间",trigger:"blur"}],value:[{required:!0,message:"请输入属性值",trigger:"blur"}]},De={propertyKey:[{required:!0,message:"请输入属性名",trigger:"blur"}],time:[{required:!0,validator:(l,e,a)=>{n.createMode==="single"&&!e?a(new Error("请输入时间")):a()},trigger:"blur"}],value:[{required:!0,validator:(l,e,a)=>{n.createMode==="single"&&!e?a(new Error("请输入属性值")):a()},trigger:"blur"}],startTime:[{required:!0,validator:(l,e,a)=>{n.createMode==="range"&&!e?a(new Error("请输入开始时间")):a()},trigger:"blur"}],endTime:[{required:!0,validator:(l,e,a)=>{n.createMode==="range"&&!e?a(new Error("请输入结束时间")):a()},trigger:"blur"}],rangeValue:[{required:!0,validator:(l,e,a)=>{n.createMode==="range"&&!e?a(new Error("请输入属性值")):a()},trigger:"blur"}]},Ke=l=>{console.log(`清理节点 ${l} 的所有图表`);const e=[];for(const a in K.value)if(a.startsWith(`${l}_`)){console.log(`销毁图表实例: ${a}`);const s=K.value[a];s._resizeHandler&&window.removeEventListener("resize",s._resizeHandler),s.dispose(),e.push(a)}e.forEach(a=>{delete K.value[a],delete D.value[a]})},Fe=async l=>{if(!$.startTime||!$.endTime){w.warning("请在页面右上角输入时间范围");return}console.log("开始查询时态数据，节点ID:",l.id),console.log("时间范围:",$.startTime,"到",$.endTime),console.log("时态属性列表:",l.temporalProperties),Ke(l.id),l.temporalLoading=!0,l.temporalCharts=[];try{const e=$.startTime,a=$.endTime,s=l.temporalProperties.map(async d=>{try{console.log(`查询时态属性: ${d}`);const T=await C.getNodeTemporalPropertyRange(l.id,d,e,a);console.log(`属性 ${d} 响应数据:`,T.data);const k=T.data||{},U=Object.entries(k).map(([_,h])=>{const N=J(_);return console.log(`时间转换: ${_} -> ${N}`),{time:N,value:h,originalTime:_}}).sort((_,h)=>_.originalTime.localeCompare(h.originalTime));return console.log(`属性 ${d} 转换后的图表数据:`,U),{propertyName:d,data:U}}catch(T){return console.error(`查询时态属性 ${d} 失败:`,T),{propertyName:d,data:[]}}}),i=await Promise.all(s);console.log("所有图表数据:",i),l.temporalCharts=i.filter(d=>d.data.length>0),console.log("过滤后的图表数据:",l.temporalCharts),await rl(),console.log("DOM更新完成，开始渲染图表"),setTimeout(()=>{l.temporalCharts.forEach((d,T)=>{console.log(`渲染第 ${T+1} 个图表:`,d.propertyName),ce(l.id,d)})},100),l.temporalCharts.length===0?w.info("在指定时间范围内没有找到时态属性数据"):w.success(`成功生成 ${l.temporalCharts.length} 个时态属性图表`)}catch(e){console.error("查询时态数据失败:",e),w.error("查询时态数据失败: "+(e.message||"未知错误"))}finally{l.temporalLoading=!1}},J=l=>{if(l.length===7){const e=l.substring(0,1).padStart(2,"0"),a=l.substring(1,3),s=l.substring(3,5),i=l.substring(5,7);return`2010-${e}-${a} ${s}:${i}`}return l},ce=(l,e)=>{const a=`${l}_${e.propertyName}`;console.log(`尝试渲染图表，key: ${a}`);const s=D.value[a];if(console.log("图表元素:",s),!s){console.warn(`找不到图表元素: ${a}`);let i=0;const d=8,T=()=>{setTimeout(()=>{i++;const k=D.value[a];console.log(`第 ${i} 次重试查找图表元素 ${a}:`,k),k&&k.offsetParent!==null?ge(k,l,e):i<d?T():console.error(`经过 ${d} 次重试仍然找不到图表元素: ${a}`)},100+50*i)};T();return}if(s.offsetParent===null){console.warn(`图表元素 ${a} 不可见，延迟渲染`),setTimeout(()=>ce(l,e),200);return}ge(s,l,e)},ge=(l,e,a)=>{const s=`${e}_${a.propertyName}`;K.value[s]&&(console.log(`销毁已存在的图表实例: ${s}`),K.value[s].dispose()),console.log(`创建新的图表实例: ${s}`),console.log("图表数据:",a),console.log("图表元素尺寸:",{width:l.offsetWidth,height:l.offsetHeight,clientWidth:l.clientWidth,clientHeight:l.clientHeight});try{(l.offsetWidth===0||l.offsetHeight===0)&&(console.warn("图表容器尺寸为0，强制设置尺寸"),l.style.width="100%",l.style.height="150px",l.style.minHeight="150px");const i=nl(l,null,{width:l.offsetWidth||800,height:l.offsetHeight||150});if(K.value[s]=i,!a.data||a.data.length===0){console.warn("图表数据为空");const _={xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{name:a.propertyName,type:"line",data:[]}],grid:{left:"10%",right:"10%",bottom:"20%",top:"10%",containLabel:!0}};i.setOption(_);return}const T=[...a.data].sort((_,h)=>{const N=J(_.time),O=J(h.time);return new Date(N).getTime()-new Date(O).getTime()}).map(_=>{const h=J(_.time);return[new Date(h).getTime(),_.value]});console.log("转换后的时间戳数据:",T);const k={tooltip:{trigger:"axis",formatter:function(_){if(_&&_.length>0){const h=_[0];return`时间: ${new Date(h.value[0]).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}<br/>值: ${h.value[1]}`}return""}},xAxis:{type:"time",axisLabel:{formatter:function(_){return new Date(_).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},rotate:45,fontSize:10,interval:"auto"},splitLine:{show:!0,lineStyle:{color:"#e0e0e0",width:1,type:"dashed"}}},yAxis:{type:"value",axisLabel:{fontSize:10}},series:[{name:a.propertyName,type:"line",data:T,smooth:!0,lineStyle:{width:2,color:"#409eff"},symbolSize:4,symbol:"circle"}],grid:{left:"10%",right:"10%",bottom:"20%",top:"10%",containLabel:!0},animation:!0,animationDuration:1e3};console.log("最终图表配置:",k),i.setOption(k,!0),setTimeout(()=>{i.resize()},100),console.log(`图表 ${s} 渲染完成`);const U=()=>{i&&!i.isDisposed()&&i.resize()};window.addEventListener("resize",U),i._resizeHandler=U}catch(i){console.error(`渲染图表 ${s} 时发生错误:`,i)}},Ie=(l,e)=>{console.log("打开设置时态属性对话框:",l,e),c.nodeId=l,c.propertyKey=e,c.time="",c.value="",H.value=!0},Me=(l,e)=>{console.log("打开设置时态属性范围对话框:",l,e),g.nodeId=l,g.propertyKey=e,g.startTime="",g.endTime="",g.value="",B.value=!0},qe=()=>{c.nodeId="",c.propertyKey="",c.time="",c.value=""},Ae=()=>{g.nodeId="",g.propertyKey="",g.startTime="",g.endTime="",g.value=""},Se=async()=>{var l,e;if(console.log("提交设置时态属性:",c),!!se.value)try{await se.value.validate(),oe.value=!0,console.log("调用API - setTemporalProperty:",{id:c.nodeId,key:c.propertyKey,time:c.time,value:c.value}),await C.setTemporalProperty(c.nodeId,c.propertyKey,c.time,c.value),w.success("时态属性设置成功"),H.value=!1,await x()}catch(a){console.error("设置时态属性失败:",a),w.error("设置时态属性失败: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||a.message))}finally{oe.value=!1}},He=async()=>{var l,e;if(ne.value)try{await ne.value.validate(),ae.value=!0,await C.setTemporalPropertyRange(g.nodeId,g.propertyKey,g.startTime,g.endTime,g.value),w.success("时态属性范围设置成功"),B.value=!1,await x()}catch(a){console.error("设置时态属性范围失败:",a),w.error("设置时态属性范围失败: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||a.message))}finally{ae.value=!1}},Be=async(l,e)=>{var a,s;console.log("删除时态属性:",l,e);try{await _e.confirm(`确认删除节点 ${l} 的时态属性 "${e}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),console.log("调用API - deleteTemporalProperty:",{id:l,key:e}),await C.deleteTemporalProperty(l,e),w.success("时态属性删除成功"),await x()}catch(i){if(i==="cancel"){console.log("用户取消删除操作");return}console.error("删除时态属性失败:",i),w.error("删除时态属性失败: "+(((s=(a=i.response)==null?void 0:a.data)==null?void 0:s.message)||i.message))}},Ee=l=>{console.log("打开新建时态属性对话框:",l),n.nodeId=l,n.propertyKey="",n.createMode="single",n.time="",n.value="",n.startTime="",n.endTime="",n.rangeValue="",E.value=!0},Oe=()=>{n.nodeId="",n.propertyKey="",n.createMode="single",n.time="",n.value="",n.startTime="",n.endTime="",n.rangeValue=""},je=async()=>{var l,e;if(console.log("提交新建时态属性:",n),!!ie.value)try{await ie.value.validate(),re.value=!0,n.createMode==="single"?(console.log("调用API - setTemporalProperty (单个时间点):",{id:n.nodeId,key:n.propertyKey,time:n.time,value:n.value}),await C.setTemporalProperty(n.nodeId,n.propertyKey,n.time,n.value),w.success("单个时间点时态属性创建成功")):(console.log("调用API - setTemporalPropertyRange (时间范围):",{id:n.nodeId,key:n.propertyKey,startTime:n.startTime,endTime:n.endTime,value:n.rangeValue}),await C.setTemporalPropertyRange(n.nodeId,n.propertyKey,n.startTime,n.endTime,n.rangeValue),w.success("时间范围时态属性创建成功")),E.value=!1,await x()}catch(a){console.error("创建时态属性失败:",a),w.error("创建时态属性失败: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||a.message))}finally{re.value=!1}};return(l,e)=>{const a=b("el-input"),s=b("el-form-item"),i=b("el-form"),d=b("el-button"),T=b("el-tooltip"),k=b("el-option"),U=b("el-select"),_=b("el-descriptions-item"),h=b("el-descriptions"),N=b("el-divider"),O=b("el-tag"),We=b("el-empty"),fe=b("el-card"),q=b("el-table-column"),Ge=b("el-table"),Je=b("el-pagination"),de=b("el-col"),Qe=b("el-row"),Q=b("el-dialog"),ye=b("el-radio"),Xe=b("el-radio-group"),Ye=ll("loading");return u(),f("div",dl,[t(fe,{class:"node-card"},{header:r(()=>[y("div",ul,[e[30]||(e[30]=y("span",null,"节点管理",-1)),y("div",pl,[y("div",ml,[t(i,{inline:!0,class:"time-form"},{default:r(()=>[t(s,{label:"时间范围:"},{default:r(()=>[t(a,{modelValue:$.startTime,"onUpdate:modelValue":e[0]||(e[0]=o=>$.startTime=o),placeholder:"开始时间 (如: 05010005)",style:{width:"120px"},class:"time-input"},null,8,["modelValue"]),e[28]||(e[28]=y("span",{class:"time-separator"},"至",-1)),t(a,{modelValue:$.endTime,"onUpdate:modelValue":e[1]||(e[1]=o=>$.endTime=o),placeholder:"结束时间 (如: 05010540)",style:{width:"120px"},class:"time-input"},null,8,["modelValue"])]),_:1})]),_:1})]),y("div",cl,[t(T,{content:"刷新",placement:"top"},{default:r(()=>[t(d,{icon:S(al),circle:"",onClick:x},null,8,["icon"])]),_:1}),t(d,{type:"primary",onClick:Pe},{default:r(()=>e[29]||(e[29]=[p("创建节点")])),_:1})])])])]),default:r(()=>[t(i,{inline:!0,class:"search-form"},{default:r(()=>[t(s,{label:"标签过滤"},{default:r(()=>[t(U,{modelValue:G.label,"onUpdate:modelValue":e[2]||(e[2]=o=>G.label=o),clearable:"",placeholder:"选择标签",onChange:$e},{default:r(()=>[(u(!0),f(R,null,z(ee.value,o=>(u(),j(k,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),tl((u(),j(Ge,{data:we.value,border:"",style:{width:"100%"},height:"calc(100vh - 330px)"},{default:r(()=>[t(q,{type:"expand"},{default:r(o=>[t(fe,{class:"node-properties"},{header:r(()=>e[31]||(e[31]=[y("div",{class:"card-header"},[y("span",null,"节点属性")],-1)])),default:r(()=>[t(h,{border:""},{default:r(()=>[(u(!0),f(R,null,z(o.row.properties,(m,P)=>(u(),j(_,{key:P,label:P},{default:r(()=>[p(L(m),1)]),_:2},1032,["label"]))),128))]),_:2},1024),y("div",gl,[t(N,{"content-position":"left"},{default:r(()=>e[32]||(e[32]=[p("时态属性")])),_:1}),y("div",fl,[y("div",yl,[e[34]||(e[34]=y("h4",null,"时态属性列表:",-1)),t(d,{size:"small",type:"success",onClick:m=>Ee(o.row.id),icon:S(ve)},{default:r(()=>e[33]||(e[33]=[p(" 新建时态属性 ")])),_:2},1032,["onClick","icon"])]),o.row.temporalProperties&&o.row.temporalProperties.length>0?(u(),f(R,{key:0},[y("div",vl,[t(d,{type:"primary",onClick:m=>Fe(o.row),loading:o.row.temporalLoading,disabled:!$.startTime||!$.endTime},{default:r(()=>e[35]||(e[35]=[p(" 查询时态数据 ")])),_:2},1032,["onClick","loading","disabled"]),!$.startTime||!$.endTime?(u(),f("span",bl," 请在页面右上角输入时间范围 ")):ue("",!0)]),o.row.temporalCharts&&o.row.temporalCharts.length>0?(u(),f("div",_l,[(u(!0),f(R,null,z(o.row.temporalCharts,(m,P)=>(u(),f("div",{key:`chart-${o.row.id}-${m.propertyName}`,class:"chart-container"},[y("h4",null,L(m.propertyName)+" 时间变化图",1),y("div",{ref_for:!0,ref:X=>Te(X,o.row.id,m.propertyName),class:"chart",style:{width:"100%",height:"150px"},id:`chart-${o.row.id}-${m.propertyName}`},null,8,Tl)]))),128))])):ue("",!0),(u(!0),f(R,null,z(o.row.temporalProperties,m=>(u(),f("div",{class:"temporal-property-item",key:m},[t(O,{type:"info",class:"temporal-property-tag"},{default:r(()=>[p(L(m),1)]),_:2},1024),y("div",wl,[t(d,{size:"small",type:"primary",onClick:P=>Ie(o.row.id,m)},{default:r(()=>e[36]||(e[36]=[p(" 设置值 ")])),_:2},1032,["onClick"]),t(d,{size:"small",type:"warning",onClick:P=>Me(o.row.id,m)},{default:r(()=>e[37]||(e[37]=[p(" 设置范围 ")])),_:2},1032,["onClick"]),t(d,{size:"small",type:"danger",onClick:P=>Be(o.row.id,m)},{default:r(()=>e[38]||(e[38]=[p(" 删除 ")])),_:2},1032,["onClick"])])]))),128))],64)):(u(),f("div",Vl,[t(We,{description:"暂无时态属性","image-size":80},{description:r(()=>e[39]||(e[39]=[y("span",{class:"text-muted"},"该节点还没有时态属性，点击上方按钮创建",-1)])),_:1})]))])])]),_:2},1024)]),_:1}),t(q,{prop:"id",label:"ID",width:"80"}),t(q,{label:"标签","min-width":"150"},{default:r(o=>[(u(!0),f(R,null,z(o.row.labels,m=>(u(),j(O,{key:m,class:"tag-item",effect:"plain"},{default:r(()=>[p(L(m),1)]),_:2},1024))),128))]),_:1}),t(q,{label:"属性","min-width":"180"},{default:r(o=>[Object.keys(o.row.properties).length>0?(u(),f("div",kl,[(u(!0),f(R,null,z(o.row.properties,(m,P,X)=>(u(),f("div",{key:P,class:"property-preview"},[X<2?(u(),f(R,{key:0},[y("strong",null,L(P)+":",1),p(" "+L(m),1)],64)):X===2?(u(),f(R,{key:1},[p(" ... ")],64)):ue("",!0)]))),128))])):(u(),f("span",Cl,"无属性"))]),_:1}),t(q,{label:"度数",width:"100"},{default:r(o=>[t(T,{content:"连接的关系数量",placement:"top"},{default:r(()=>[t(O,{type:"info"},{default:r(()=>[p(L(o.row.degree||0),1)]),_:2},1024)]),_:2},1024)]),_:1}),t(q,{label:"操作",width:"200",fixed:"right"},{default:r(o=>[t(d,{type:"primary",size:"small",onClick:m=>he(o.row),icon:S(ol)},{default:r(()=>e[40]||(e[40]=[p(" 编辑 ")])),_:2},1032,["onClick","icon"]),t(d,{type:"danger",size:"small",onClick:m=>Ue(o.row),icon:S(be)},{default:r(()=>e[41]||(e[41]=[p(" 删除 ")])),_:2},1032,["onClick","icon"])]),_:1})]),_:1},8,["data"])),[[Ye,Y.value]]),y("div",$l,[t(Je,{"current-page":F.value,"onUpdate:currentPage":e[3]||(e[3]=o=>F.value=o),"page-size":W.value,"onUpdate:pageSize":e[4]||(e[4]=o=>W.value=o),"page-sizes":[50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:me.value,onSizeChange:ke,onCurrentChange:Ce},null,8,["current-page","page-size","total"])])]),_:1}),t(Q,{modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=o=>I.value=o),title:M.value?"编辑节点":"创建节点",width:"800px","destroy-on-close":""},{footer:r(()=>[y("span",Pl,[t(d,{onClick:e[6]||(e[6]=o=>I.value=!1)},{default:r(()=>e[44]||(e[44]=[p("取消")])),_:1}),t(d,{type:"primary",onClick:Ne,loading:Z.value},{default:r(()=>e[45]||(e[45]=[p(" 确认 ")])),_:1},8,["loading"])])]),default:r(()=>[t(i,{model:V,rules:Ve,ref_key:"nodeFormRef",ref:le,"label-width":"100px"},{default:r(()=>[t(s,{label:"节点标签",prop:"labels"},{default:r(()=>[t(U,{modelValue:V.labels,"onUpdate:modelValue":e[5]||(e[5]=o=>V.labels=o),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择或输入标签"},{default:r(()=>[(u(!0),f(R,null,z(ee.value,o=>(u(),j(k,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(N,{"content-position":"left"},{default:r(()=>e[42]||(e[42]=[p("节点属性")])),_:1}),(u(!0),f(R,null,z(V.properties,(o,m)=>(u(),f("div",{key:m,class:"property-item"},[t(Qe,{gutter:10},{default:r(()=>[t(de,{span:10},{default:r(()=>[t(s,{prop:"properties."+m+".key",rules:{required:!0,message:"请输入属性名",trigger:"blur"}},{default:r(()=>[t(a,{modelValue:o.key,"onUpdate:modelValue":P=>o.key=P,placeholder:"属性名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1024),t(de,{span:10},{default:r(()=>[t(s,{prop:"properties."+m+".value",rules:{required:!0,message:"请输入属性值",trigger:"blur"}},{default:r(()=>[t(a,{modelValue:o.value,"onUpdate:modelValue":P=>o.value=P,placeholder:"属性值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:2},1024),t(de,{span:4},{default:r(()=>[t(d,{type:"danger",icon:S(be),circle:"",onClick:P=>xe(m)},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024)]))),128)),t(s,null,{default:r(()=>[t(d,{type:"primary",icon:S(ve),onClick:Re},{default:r(()=>e[43]||(e[43]=[p("添加属性")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(Q,{modelValue:H.value,"onUpdate:modelValue":e[12]||(e[12]=o=>H.value=o),title:"设置时态属性",width:"600px","destroy-on-close":"",onClose:qe},{footer:r(()=>[y("span",hl,[t(d,{onClick:e[11]||(e[11]=o=>H.value=!1)},{default:r(()=>e[46]||(e[46]=[p("取消")])),_:1}),t(d,{type:"primary",onClick:Se,loading:oe.value},{default:r(()=>e[47]||(e[47]=[p(" 确认 ")])),_:1},8,["loading"])])]),default:r(()=>[t(i,{model:c,rules:ze,ref_key:"temporalPropertyFormRef",ref:se,"label-width":"100px"},{default:r(()=>[t(s,{label:"属性名"},{default:r(()=>[t(a,{modelValue:c.propertyKey,"onUpdate:modelValue":e[8]||(e[8]=o=>c.propertyKey=o),disabled:""},null,8,["modelValue"])]),_:1}),t(s,{label:"时间",prop:"time"},{default:r(()=>[t(a,{modelValue:c.time,"onUpdate:modelValue":e[9]||(e[9]=o=>c.time=o),placeholder:"请输入时间 (如: 5010010)"},null,8,["modelValue"])]),_:1}),t(s,{label:"属性值",prop:"value"},{default:r(()=>[t(a,{modelValue:c.value,"onUpdate:modelValue":e[10]||(e[10]=o=>c.value=o),placeholder:"请输入属性值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(Q,{modelValue:B.value,"onUpdate:modelValue":e[18]||(e[18]=o=>B.value=o),title:"设置时态属性范围",width:"600px","destroy-on-close":"",onClose:Ae},{footer:r(()=>[y("span",Rl,[t(d,{onClick:e[17]||(e[17]=o=>B.value=!1)},{default:r(()=>e[48]||(e[48]=[p("取消")])),_:1}),t(d,{type:"primary",onClick:He,loading:ae.value},{default:r(()=>e[49]||(e[49]=[p(" 确认 ")])),_:1},8,["loading"])])]),default:r(()=>[t(i,{model:g,rules:Le,ref_key:"temporalRangeFormRef",ref:ne,"label-width":"100px"},{default:r(()=>[t(s,{label:"属性名"},{default:r(()=>[t(a,{modelValue:g.propertyKey,"onUpdate:modelValue":e[13]||(e[13]=o=>g.propertyKey=o),disabled:""},null,8,["modelValue"])]),_:1}),t(s,{label:"开始时间",prop:"startTime"},{default:r(()=>[t(a,{modelValue:g.startTime,"onUpdate:modelValue":e[14]||(e[14]=o=>g.startTime=o),placeholder:"请输入开始时间 (如: 5010010)"},null,8,["modelValue"])]),_:1}),t(s,{label:"结束时间",prop:"endTime"},{default:r(()=>[t(a,{modelValue:g.endTime,"onUpdate:modelValue":e[15]||(e[15]=o=>g.endTime=o),placeholder:"请输入结束时间 (如: 5010540)"},null,8,["modelValue"])]),_:1}),t(s,{label:"属性值",prop:"value"},{default:r(()=>[t(a,{modelValue:g.value,"onUpdate:modelValue":e[16]||(e[16]=o=>g.value=o),placeholder:"请输入属性值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(Q,{modelValue:E.value,"onUpdate:modelValue":e[27]||(e[27]=o=>E.value=o),title:"新建时态属性",width:"700px","destroy-on-close":"",onClose:Oe},{footer:r(()=>[y("span",xl,[t(d,{onClick:e[26]||(e[26]=o=>E.value=!1)},{default:r(()=>e[52]||(e[52]=[p("取消")])),_:1}),t(d,{type:"primary",onClick:je,loading:re.value},{default:r(()=>e[53]||(e[53]=[p(" 确认 ")])),_:1},8,["loading"])])]),default:r(()=>[t(i,{model:n,rules:De,ref_key:"createTemporalPropertyFormRef",ref:ie,"label-width":"100px"},{default:r(()=>[t(s,{label:"属性名",prop:"propertyKey"},{default:r(()=>[t(a,{modelValue:n.propertyKey,"onUpdate:modelValue":e[19]||(e[19]=o=>n.propertyKey=o),placeholder:"请输入属性名"},null,8,["modelValue"])]),_:1}),t(s,{label:"创建类型"},{default:r(()=>[t(Xe,{modelValue:n.createMode,"onUpdate:modelValue":e[20]||(e[20]=o=>n.createMode=o)},{default:r(()=>[t(ye,{label:"single"},{default:r(()=>e[50]||(e[50]=[p("单个时间点")])),_:1}),t(ye,{label:"range"},{default:r(()=>e[51]||(e[51]=[p("时间范围")])),_:1})]),_:1},8,["modelValue"])]),_:1}),n.createMode==="single"?(u(),f(R,{key:0},[t(s,{label:"时间",prop:"time"},{default:r(()=>[t(a,{modelValue:n.time,"onUpdate:modelValue":e[21]||(e[21]=o=>n.time=o),placeholder:"请输入时间 (如: 5010010)"},null,8,["modelValue"])]),_:1}),t(s,{label:"属性值",prop:"value"},{default:r(()=>[t(a,{modelValue:n.value,"onUpdate:modelValue":e[22]||(e[22]=o=>n.value=o),placeholder:"请输入属性值"},null,8,["modelValue"])]),_:1})],64)):(u(),f(R,{key:1},[t(s,{label:"开始时间",prop:"startTime"},{default:r(()=>[t(a,{modelValue:n.startTime,"onUpdate:modelValue":e[23]||(e[23]=o=>n.startTime=o),placeholder:"请输入开始时间 (如: 5010010)"},null,8,["modelValue"])]),_:1}),t(s,{label:"结束时间",prop:"endTime"},{default:r(()=>[t(a,{modelValue:n.endTime,"onUpdate:modelValue":e[24]||(e[24]=o=>n.endTime=o),placeholder:"请输入结束时间 (如: 5010540)"},null,8,["modelValue"])]),_:1}),t(s,{label:"属性值",prop:"rangeValue"},{default:r(()=>[t(a,{modelValue:n.rangeValue,"onUpdate:modelValue":e[25]||(e[25]=o=>n.rangeValue=o),placeholder:"请输入属性值"},null,8,["modelValue"])]),_:1})],64))]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Fl=il(Nl,[["__scopeId","data-v-0ae49177"]]);export{Fl as default};
